HTML, возвращаемый страницей, включает в себя ссылки на файлы CSS (для стилизации страницы),
файлы JavaScript (для обеспечения функциональности на стороне клиента – в данном случае для валидации формы) и, возможно, изображения
и другие ресурсы (хотя у вас нет ничего другого в этом приложении).
Браузер должен запросить каждый из этих дополнительных файлов
и дождаться, пока сервер вернет их до загрузки всей страницы. Если вы
занимаетесь локальной разработкой, то все это происходит быстро, так
как запросу вряд ли предстоит долгий путь. Но как только вы разворачиваете свое приложение в промышленном окружении – ситуация меняется.

Пользователи будут запрашивать страницы из вашего приложения на
разном расстоянии от сервера через широкий спектр сетевых скоростей.
Количество и размер запросов и ответов для вашего приложения будут
оказывать огромное влияние на общую субъективную скорость приложения. Это, в свою очередь, может существенно повлиять на то, как пользователи воспринимают ваш сайт, а для сайтов онлайн-торговли даже на
то, сколько денег они тратят

Отличный способ выяснить, как ваше приложение будет вести себя
в  неоптимальных сетях, – использовать функцию занижения скорости
интернета (network throttling) в  инструментах разработчика Chrome
и Edge. Так вы можете имитировать задержки и скорости сети, связанные с различными типами сетей, чтобы получить представление о том,
как ваше приложение ведет себя в реальных условиях.


Время, необходимое для полной загрузки страницы приложения, в основном зависит от двух факторов:
 общий размер ответов – это чистая математика; вы можете вернуть
данные только на определенной скорости, поэтому чем больше данных нужно вернуть, тем больше времени для этого потребуется;
 количество запросов  – как правило, чем больше запросов должен
сделать браузер, тем больше времени требуется для полной загрузки страницы. В  HTTP/1.0 и  HTTP/1.1 можно сделать только шесть
одновременных запросов к серверу, поэтому все запросы, которые
идут после шестого, должны дождаться завершения более раннего
запроса. Протокол HTTP/2.0, который поддерживается Kestrel, не
имеет такого ограничения, но нельзя всегда полагаться на то, что
клиенты его используют.

Как повысить скорость работы приложения, если нужны все файлы,
которые вы предоставляете? В целом это большая тема со множеством
возможностей, таких как использование сети доставки содержимого для
обслуживания статических файлов. Два самых простых способа повысить производительность сайта: использовать упаковку и минификацию
кода, чтобы уменьшить количество и размер запросов, которые необходимо сделать браузеру, дабы загрузить приложение.

# css и javascript 

Упаковка – это процесс объединения нескольких
файлов в один файл с целью уменьшить количество запросов. 

Точно так же, когда вы пишете код JavaScript, вы должны использовать
описательные имена переменных, комментарии, где это необходимо,
и пробелы для создания легко читаемого и отлаживаемого кода. Когда
вы приступаете к  развертыванию скриптов, то можете обрабатывать
и  оптимизировать их размер, а  не удобочитаемость. Этот процесс называется минификацией

Минификация включает в  себя обработку кода
для уменьшения его размера без изменения его поведения. Такая
обработка имеет много разных уровней, которые обычно включают в себя удаление комментариев и пробелов, а также переименование переменных, чтобы давать им более короткие имена, или
полное удаление целых разделов кода, если они не используются.

Оптимизация статических файлов с  помощью упаковки и  минификации может обеспечить бесплатный рост производительности вашего приложения при развертывании его в  промышленном окружении,
при этом позволяя осуществлять разработку, используя легко читаемые
и разделенные файлы.


```Csharp
    <environment include="Development">
        <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
        <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap-theme.min.css" />
        <link rel="stylesheet" href="~/css/custom.css" asp-append-version="true"/>
    </environment>
```

## cdn

Для распространенных файлов, совместно используемых несколькими приложениями, например jQuery или Bootstrap, можно использовать файлы из CDN. Это веб-сайты, на которых размещены часто используемые файлы, поэтому вашему приложению не нужно самому
их предоставлять.

Используйте тег-хелперы ссылок и  скриптов, чтобы проверить правильность загрузки файла из CDN. Они могут проверить, что файл был
скачан клиентом, и гарантируют, что ваш сервер будет использоваться
в качестве запасного варианта в случае сбоя CDN

<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
 asp-fallback-test-class="sr-only"
 asp-fallback-test-property="position"
 asp-fallback-test-value="absolute"
 asp-fallback-href="~/lib/bootstrap/dist/css/bootstrap.min.css" />


Оптимизация статических файлов – важный шаг, который необходимо рассмотреть, прежде чем размещать приложение в  промышленном
окружении, поскольку это может существенно повлиять на производительность. К счастью, пакет BuildBundlerMinifier упрощает оптимизацию
файлов CSS и JavaScript. Если сочетать его с обслуживанием часто используемых файлов из CDN, то ваше приложение будет таким быстрым, насколько это возможно для пользователей в промышленном окружении.

## bundle minifer config

```json
[
  {
    "outputFileName": "wwwroot/output/bundle.css",
    "inputFiles": [
      "!wwwroot/css/lib/**/*.css", // globbing patterns are supported
      "wwwroot/css//site.css"
    ],
    "minify": {
      "enabled": true,
      "commentMode": "all"
    }
  },

  {
    "outputFileName": "wwwroot/output/all.js",
    "inputFiles": [
      "wwwroot/js/*.js",
      "!wwwroot/js/ignore.js" // start with a ! to exclude files
    ]
  }

  
]
```

